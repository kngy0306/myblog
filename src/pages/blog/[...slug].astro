---
import { type CollectionEntry, getCollection } from "astro:content";
import { render } from "astro:content";
import BlogLayout from "@/layouts/BlogLayout.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");
  return posts.map((post) => ({
    params: { slug: post.slug },
    props: post,
  }));
}

type Props = CollectionEntry<"blog">;

const post: Props = Astro.props;
const { Content } = await render(post);

// Use dynamic OGP image
const ogImageSrc = `/blog/${post.slug}.og.png`;
---

<BlogLayout
  title={post.data.title}
  description={post.data.description}
  ogImage={ogImageSrc}
>
  <time class="date text-muted-foreground">
    {
      new Date(post.data.date).toLocaleDateString("ja-JP", {
        year: "numeric",
        month: "2-digit",
        day: "2-digit",
      })
    }
  </time>
  <span class="block text-4xl font-bold mt-2 mb-15">{post.data.title}</span>
  <Content />
</BlogLayout>
